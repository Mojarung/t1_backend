# ü§ñ AI HR Assistant - –ü–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —É–º–Ω—ã–π –ø–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è HR-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ–º–æ–≥–∞–µ—Ç HR-–º–µ–Ω–µ–¥–∂–µ—Ä–∞–º –Ω–∞—Ö–æ–¥–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è –≤–∞–∫–∞–Ω—Å–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è:

- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏
- **–£–º–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é**: –ü–æ—ç—Ç–∞–ø–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞–≤—ã–∫–∞–º –∏ –æ–ø—ã—Ç—É
- **LLM-–∞–Ω–∞–ª–∏–∑**: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∞–º–º–∞—Ä–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
- **RAG-–º–æ–¥–µ–ª—å**: –ü–æ–∏—Å–∫ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **HR –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–∞–∫–∞–Ω—Å–∏–∏ –∏ —Ç—Ä–µ–±—É–µ–º—ã–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏
2. **–ë–∞–∑–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –ø–æ –∫–ª—é—á–µ–≤—ã–º –Ω–∞–≤—ã–∫–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Python –¥–ª—è backend)
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –µ—Å–ª–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ (> –ø–æ—Ä–æ–≥–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è)
4. **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫** —Å—Ä–µ–¥–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π (cosine similarity)
5. **AI-–∞–Ω–∞–ª–∏–∑** –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–≥–æ —Å–∞–º–º–∞—Ä–∏
6. **–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ** –∏ –≤–æ–∑–≤—Ä–∞—Ç —Å–ø–∏—Å–∫–∞ —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

## üõ†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
HR Request ‚Üí FastAPI Endpoint ‚Üí HRCandidateSearchService ‚Üí {
    ‚îú‚îÄ‚îÄ PostgreSQL (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π)
    ‚îú‚îÄ‚îÄ pgvector (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫) 
    ‚îú‚îÄ‚îÄ Scibox LLM (embeddings + chat)
    ‚îî‚îÄ‚îÄ LangChain (RAG pipeline)
}
```

## üì° API –≠–Ω–¥–ø–æ–∏–Ω—Ç

### POST `/candidate-selection/ai-search`

–ü–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Authorization: Bearer <jwt_token>
Content-Type: application/json
```

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
    "job_title": "Senior Python Developer",
    "job_description": "–ò—â–µ–º –æ–ø—ã—Ç–Ω–æ–≥–æ Python —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Django, PostgreSQL, Docker. –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—ã—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ REST API –∏ —Ä–∞–±–æ—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ.",
    "required_skills": ["Python", "Django", "PostgreSQL"],
    "additional_requirements": "–û–ø—ã—Ç —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –±—É–¥–µ—Ç –ø–ª—é—Å–æ–º",
    "experience_level": "senior",
    "max_candidates": 15,
    "threshold_filter_limit": 40
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "job_title": "Senior Python Developer",
    "total_profiles_found": 23,
    "processed_by_ai": 15,
    "filters_applied": [
        "Skills: Python, Django, PostgreSQL",
        "Experience: senior",
        "Additional keywords: backend, api, microservices"
    ],
    "candidates": [
        {
            "user_id": 42,
            "full_name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
            "email": "ivan.petrov@company.com",
            "current_position": "Python Developer",
            "experience_years": "5 –ª–µ—Ç",
            "key_skills": ["Python", "Django", "REST API", "Docker"],
            "programming_languages": ["Python", "JavaScript", "Go"],
            "match_score": 0.92,
            "ai_summary": "–û—Ç–ª–∏—á–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç —Å 5-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º –≤ Python –∏ Django. –ò–º–µ–µ—Ç –ø—Ä—è–º–æ–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å PostgreSQL –∏ Docker. –£—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.",
            "strengths": [
                "–ì–ª—É–±–æ–∫–∏–µ –∑–Ω–∞–Ω–∏—è Python –∏ Django",
                "–û–ø—ã—Ç —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏",
                "–ó–Ω–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏"
            ],
            "growth_areas": [
                "–ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –ª–∏–¥–µ—Ä—Å–∫–∏–º –Ω–∞–≤—ã–∫–∞–º"
            ],
            "similarity_score": 0.87
        }
    ],
    "processing_time_seconds": 4.2
}
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–∏—Å–∫ Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
```bash
curl -X POST "http://localhost:8000/candidate-selection/ai-search" \
  -H "Authorization: Bearer <your-jwt-token>" \
  -H "Content-Type: application/json" \
  -d '{
    "job_title": "Senior Backend Developer",
    "job_description": "–ù—É–∂–µ–Ω –æ–ø—ã—Ç–Ω—ã–π backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏. Python, Django, PostgreSQL, Redis, Docker.",
    "required_skills": ["Python", "Django"],
    "experience_level": "senior",
    "max_candidates": 10
  }'
```

### –ü–æ–∏—Å–∫ Data Analyst
```bash
curl -X POST "http://localhost:8000/candidate-selection/ai-search" \
  -H "Authorization: Bearer <your-jwt-token>" \
  -H "Content-Type: application/json" \
  -d '{
    "job_title": "Data Analyst",
    "job_description": "–ò—â–µ–º –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏. SQL, Python, Power BI, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑.",
    "required_skills": ["SQL", "Python"],
    "additional_requirements": "–û–ø—ã—Ç —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö",
    "max_candidates": 20
  }'
```

### –ü–æ–∏—Å–∫ Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
```bash
curl -X POST "http://localhost:8000/candidate-selection/ai-search" \
  -H "Authorization: Bearer <your-jwt-token>" \
  -H "Content-Type: application/json" \
  -d '{
    "job_title": "React Developer",
    "job_description": "Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º. React, TypeScript, Redux, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.",
    "required_skills": ["React", "JavaScript"],
    "experience_level": "middle",
    "max_candidates": 15
  }'
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```python
# Scibox LLM API
SCIBOX_BASE_URL="https://llm.t1v.scibox.tech/v1"
SCIBOX_API_KEY="your-api-key-here"
SCIBOX_MODEL="Qwen2.5-72B-Instruct-AWQ"

# –í–µ–∫—Ç–æ—Ä–Ω–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–ª—è embeddings
EMBEDDING_DIMENSION=1024  # bge-m3 model
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

- **–ü–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**: 50 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–ú–∞–∫—Å–∏–º—É–º –¥–ª—è AI-–∞–Ω–∞–ª–∏–∑–∞**: 20 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **–ú–æ–¥–µ–ª—å –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**: bge-m3 (1024 –∏–∑–º–µ—Ä–µ–Ω–∏—è)
- **–ú–æ–¥–µ–ª—å –∞–Ω–∞–ª–∏–∑–∞**: Qwen2.5-72B-Instruct-AWQ
- **–ú–µ—Ç—Ä–∏–∫–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏**: Cosine similarity
- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ LLM**: 0.3 (–¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏)

## üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LangChain

```python
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ
from app.services.hr_candidate_search_service import get_hr_candidate_search_service

search_service = get_hr_candidate_search_service()
result = await search_service.search_candidates(db, request)
```

## üêõ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã:

- –ü—Ä–∏ –æ—à–∏–±–∫–µ LLM API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –±–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤–∞
- –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ embedding API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–¢–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**: 0.1-0.3 —Å–µ–∫—É–Ω–¥—ã  
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: 0.2-0.5 —Å–µ–∫—É–Ω–¥—ã
- **AI-–∞–Ω–∞–ª–∏–∑**: 2-6 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: 3-8 —Å–µ–∫—É–Ω–¥ –¥–ª—è 10-20 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. **–°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö** (`app/schemas.py`)

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è API:

```python
class CandidateSearchRequest(BaseModel):
    """–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–∏—Å–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ AI"""
    job_title: str                                    # –ù–∞–∑–≤–∞–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–∏
    job_description: str                              # –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ 
    required_skills: Optional[List[str]] = []         # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≤—ã–∫–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    additional_requirements: Optional[str] = None     # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
    experience_level: Optional[str] = None            # junior/middle/senior
    max_candidates: Optional[int] = 20                # –õ–∏–º–∏—Ç –¥–ª—è LLM –æ–±—Ä–∞–±–æ—Ç–∫–∏
    threshold_filter_limit: Optional[int] = 50        # –ü–æ—Ä–æ–≥ –¥–æ–ø. —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

class CandidateMatch(BaseModel):
    """–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–µ"""
    user_id: int
    full_name: str
    email: str
    match_score: float                                # AI –æ—Ü–µ–Ω–∫–∞ (0.0-1.0)
    ai_summary: str                                   # –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∞–º–º–∞—Ä–∏
    strengths: Optional[List[str]] = []               # –°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
    growth_areas: Optional[List[str]] = []            # –û–±–ª–∞—Å—Ç–∏ —Ä–æ—Å—Ç–∞
    similarity_score: Optional[float] = None          # –í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ

class CandidateSearchResponse(BaseModel):
    """–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∏—Å–∫–∞ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏"""
    job_title: str
    total_profiles_found: int                         # –í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    processed_by_ai: int                              # –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —á–µ—Ä–µ–∑ LLM
    filters_applied: List[str]                        # –°–ø–∏—Å–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
    candidates: List[CandidateMatch]                  # –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã
    processing_time_seconds: Optional[float] = None   # –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

#### 2. **–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å** (`app/services/hr_candidate_search_service.py`)

**HRCandidateSearchService** - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å —Å –º–µ—Ç–æ–¥–∞–º–∏:

- `search_candidates()` - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞
- `_apply_basic_filters()` - –±–∞–∑–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –Ω–∞–≤—ã–∫–∞–º
- `_apply_additional_filters()` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- `_generate_job_embedding()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏
- `_perform_vector_search()` - –ø–æ–∏—Å–∫ –ø–æ cosine similarity
- `_analyze_candidate_with_ai()` - LLM –∞–Ω–∞–ª–∏–∑ –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
- `_cosine_similarity()` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ö–æ–∂–µ—Å—Ç–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM:**
```python
def _build_llm_request(self, prompt: str, is_embedding: bool = False):
    """–°–æ–∑–¥–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ Scibox API"""
    if is_embedding:
        url = f"{base_url}/embeddings"      # bge-m3 –º–æ–¥–µ–ª—å
        model = "bge-m3"
    else:
        url = f"{base_url}/chat/completions" # Qwen2.5-72B-Instruct-AWQ
        model = "Qwen2.5-72B-Instruct-AWQ"
```

**–†–∞–±–æ—Ç–∞ —Å –≤–µ–∫—Ç–æ—Ä–∞–º–∏:**
```python
async def _perform_vector_search(self, db, job_embedding, filtered_users, limit):
    """–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ pgvector"""
    vector_results = db.query(Vec_profile, User).join(User).filter(
        Vec_profile.user_id.in_(user_ids)
    ).all()
    
    for vec_profile, user in vector_results:
        similarity = self._cosine_similarity(job_embedding, vec_profile.vector)
        candidates_with_similarity.append((user, similarity))
```

#### 3. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç** (`app/routers/candidate_selection.py`)

–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ä–æ—É—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π router:

```python
@router.post("/ai-search", response_model=CandidateSearchResponse)
async def ai_candidate_search(
    request: CandidateSearchRequest,
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_hr_user)  # –¢–æ–ª—å–∫–æ –¥–ª—è HR
):
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞:**
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è HR –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å fallback –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏

#### 4. **–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç** (`app/ai_assistant/test_candidate_search.py`)

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å 3 —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏:

```python
test_cases = [
    {
        "name": "üêç Python Backend Developer",
        "request": {
            "job_title": "Senior Python Developer",
            "required_skills": ["Python", "Django"],
            "experience_level": "senior"
        }
    },
    {
        "name": "üìä Data Analyst", 
        "request": {
            "required_skills": ["SQL", "Python"],
            "experience_level": "middle"
        }
    },
    {
        "name": "‚öõÔ∏è React Frontend Developer",
        "request": {
            "required_skills": ["React", "JavaScript"],
            "experience_level": "middle"
        }
    }
]
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –º–æ–¥–µ–ª—å `Vec_profile`:
```python
class Vec_profile(Base):
    __tablename__ = "vec_profiles"
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id"), nullable=False)
    vector = mapped_column(Vector(1024))  # pgvector –¥–ª—è bge-m3 embeddings
```

#### –ú–æ–¥–µ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–†–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–ª—è–º–∏ User –º–æ–¥–µ–ª–∏:
- `programming_languages` (JSON) - –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –Ω–∞–≤—ã–∫–∞–º
- `other_competencies` (JSON) - –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤
- `work_experience` (JSON) - –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ–ø—ã—Ç–∞ —Ä–∞–±–æ—Ç—ã
- `education` (JSON) - –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
- `about` (Text) - –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

#### –†–æ—É—Ç–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
–î–æ–±–∞–≤–ª–µ–Ω –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `candidate_selection` —Ä–æ—É—Ç–µ—Ä –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø–æ–∏—Å–∫–∞

#### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```sql
-- –ü—Ä–∏–º–µ—Ä SQL –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –Ω–∞–≤—ã–∫–∞–º Python, Django
SELECT * FROM users 
WHERE role = 'user' AND is_active = true
AND (
    json_extract_path_text(programming_languages, '$') ILIKE '%Python%'
    OR json_extract_path_text(other_competencies, '$') ILIKE '%Python%'
    OR json_extract_path_text(programming_languages, '$') ILIKE '%Django%'
    OR json_extract_path_text(other_competencies, '$') ILIKE '%Django%'
)
```

#### –≠—Ç–∞–ø 2: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ > `threshold_filter_limit` –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–∏:
```python
key_terms = ['backend', 'frontend', 'api', 'database', 'docker', 'kubernetes']
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ work_experience –∏ about –ø–æ–ª—è–º
```

#### –≠—Ç–∞–ø 3: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫
```python
# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è embedding –¥–ª—è –≤–∞–∫–∞–Ω—Å–∏–∏ —á–µ—Ä–µ–∑ bge-m3
job_embedding = await self._call_llm(job_description, is_embedding=True)

# 2. Cosine similarity —Å –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
similarity = np.dot(job_vector, profile_vector) / (norm_job * norm_profile)

# 3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é similarity
candidates.sort(key=lambda x: x[1], reverse=True)
```

#### –≠—Ç–∞–ø 4: AI –∞–Ω–∞–ª–∏–∑
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–º–ø—Ç:
```
–í–ê–ö–ê–ù–°–ò–Ø: {job_title} - {job_description}

–ö–ê–ù–î–ò–î–ê–¢:
- –ò–º—è: {full_name}
- –ù–∞–≤—ã–∫–∏: {programming_languages + other_competencies}
- –û–ø—ã—Ç: {work_experience_summary}
- –í–µ–∫—Ç–æ—Ä–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å: {similarity_score}

–ó–ê–î–ê–ß–ê: –û—Ü–µ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ç 0.0 –¥–æ 1.0, –≤—ã–¥–µ–ª–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏ –æ–±–ª–∞—Å—Ç–∏ —Ä–æ—Å—Ç–∞.
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

#### –ú–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è SQL**: 100-300ms (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã)
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: 200-500ms (pgvector –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω)  
- **AI –∞–Ω–∞–ª–∏–∑**: 150-400ms –Ω–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: 3-8 —Å–µ–∫—É–Ω–¥ –¥–ª—è 10-20 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ JSON –ø–æ–ª—è—Ö –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –¥–ª—è LLM
- –ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (0.3) –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ embeddings (–≤–æ–∑–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
# Scibox LLM API
SCIBOX_BASE_URL="https://llm.t1v.scibox.tech/v1"
SCIBOX_API_KEY="your-scibox-api-key"
SCIBOX_MODEL="Qwen2.5-72B-Instruct-AWQ"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞
DEFAULT_MAX_CANDIDATES=20
DEFAULT_THRESHOLD_LIMIT=50
EMBEDDING_DIMENSION=1024
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
```python
class HRCandidateSearchService:
    def __init__(self):
        self.provider = "scibox"
        self.embedding_dimension = 1024  # bge-m3
        self.llm_temperature = 0.3       # –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
        self.max_tokens = 1000          # –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ resilience

#### Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:
1. **LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω** ‚Üí –ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ –≤–µ–∫—Ç–æ—Ä–Ω–æ–º—É —Å—Ö–æ–¥—Å—Ç–≤—É
2. **Embedding API –æ—à–∏–±–∫–∞** ‚Üí –ù—É–ª–µ–≤–æ–π –≤–µ–∫—Ç–æ—Ä + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–∫—Å—Ç—É
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞** ‚Üí HTTP 500 —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
4. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Üí HTTP 401/403 —Å –ø–æ–Ω—è—Ç–Ω—ã–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```python
print(f"üîç Starting candidate search for: {request.job_title}")
print(f"üìä Found {len(base_candidates)} candidates after basic filtering")
print(f"ü§ñ Analyzing {len(candidates)} candidates with AI...")
print(f"‚úÖ Search completed in {processing_time:.2f}s")
```

## üîÑ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –í–µ—Ä—Å–∏—è 2.1 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQL –æ—à–∏–±–æ–∫ —Å JSON –ø–æ–ª—è–º–∏

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ PostgreSQL –æ—à–∏–±–∫–∏:
**–ü—Ä–æ–±–ª–µ–º–∞**: `operator does not exist: json ~~* unknown` –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ JSON –ø–æ–ª—è–º
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ JSON –∫ —Ç–µ–∫—Å—Ç—É —á–µ—Ä–µ–∑ `.cast(String).ilike()`

```python
# ‚ùå –ë–´–õ–û (–æ—à–∏–±–∫–∞):
User.programming_languages.ilike(f'%{skill}%')

# ‚úÖ –°–¢–ê–õ–û (—Ä–∞–±–æ—Ç–∞–µ—Ç):  
User.programming_languages.cast(String).ilike(f'%{skill}%')
```

### –í–µ—Ä—Å–∏—è 2.0 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏**: –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –Ω–∏—Ö
2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞–≤—ã–∫–æ–≤**: –£–ª—É—á—à–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –ø—É—Å—Ç—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ `required_skills`
3. **JSON –ø–æ–ª—è**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ JSON –ø–æ–ª—è–º (`programming_languages`, `other_competencies`)
4. **Fallback –ª–æ–≥–∏–∫–∞**: –î–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º LLM API
5. **–ú–æ–¥–µ–ª—å Vec_profile**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –≤ `models.py`

#### üÜï –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤**: –í–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –ª–µ—Ç—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–∏—Å–∫–µ
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ–ø—ã—Ç—É**: –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º `senior`, `middle`, `junior`
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫**: –ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—è–º `about`, `work_experience`, `education`
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏

#### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç JSON –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
python app/ai_assistant/test_json_fix.py

# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
python app/ai_assistant/test_candidate_search.py

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏
python app/ai_assistant/test_improved_candidate_search.py
```

#### üìä –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–∞:
```json
{
  "job_title": "Python Developer",
  "total_profiles_found": 12,      // ‚úÖ –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
  "processed_by_ai": 8,            // ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
  "filters_applied": [
    "Skills: Python", 
    "Experience: senior"
  ],
  "candidates": [                   // ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
    {
      "user_id": 42,
      "full_name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
      "match_score": 0.87,          // ‚úÖ AI –æ—Ü–µ–Ω–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
      "similarity_score": 0.83      // ‚úÖ –í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ
    }
  ]
}
```

#### ‚öôÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:

**1. –ú–æ–¥–µ–ª—å Vec_profile (models.py):**
```python
class Vec_profile(Base):
    __tablename__ = "vec_profiles"
    user_id = Column(Integer, ForeignKey("users.id"), primary_key=True)
    vector = mapped_column(Vector(1024))  # bge-m3 embeddings
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
```

**2. –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (hr_candidate_search_service.py):**
```python
# –ü–æ–∏—Å–∫ –ø–æ JSON –ø–æ–ª—è–º –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è json_extract_path_text
User.programming_languages.ilike(f'%{skill}%')
User.other_competencies.ilike(f'%{skill}%')
User.about.ilike(f'%{skill}%')
```

**3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤:**
```python
async def _perform_vector_search(self, db, job_embedding, filtered_users, limit):
    # –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å–æ–∑–¥–∞–µ–º –∏—Ö –Ω–∞ –ª–µ—Ç—É
    for user in users_without_vectors:
        user_profile_text = self._create_user_profile_text(user)
        user_embedding = await self._call_llm(user_profile_text, is_embedding=True)
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
```

### üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

–ï—Å–ª–∏ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `processed_by_ai: 0`:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**:
   ```sql
   -- –ï—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏?
   SELECT COUNT(*) FROM users WHERE role = 'user' AND is_active = true;
   
   -- –ï—Å—Ç—å –ª–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏?
   SELECT COUNT(*) FROM vec_profiles;
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á Scibox**:
   ```bash
   # –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ embeddings API
   curl -X POST "https://llm.t1v.scibox.tech/v1/embeddings" \
     -H "Authorization: Bearer YOUR_API_KEY" \
     -H "Content-Type: application/json" \
     -d '{"model": "bge-m3", "input": "test text"}'
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞**:
   ```bash
   # –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π
   grep "Creating vector profiles" app.log
   
   # –õ–æ–≥–∏ AI –∞–Ω–∞–ª–∏–∑–∞
   grep "Analyzing.*candidates with AI" app.log
   ```

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å –ø–æ–ª–Ω—ã–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ AI-–ø–æ–∏—Å–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (–≤–µ—Ä—Å–∏—è 2.0)*
